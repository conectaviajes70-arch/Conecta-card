
<script>
const params = new URLSearchParams(window.location.search);
const idViaje = params.get("id_viaje");

if (!idViaje) {
  document.getElementById("conecta").innerHTML = "âŒ id_viaje no recibido";
  throw new Error("id_viaje faltante");
}

fetch(`https://script.google.com/macros/s/AKfycbyA7kn6BHrvAdrxjzWwTwpd1mIjiRUup4TP_ZKvvlmuHKrv0SZ6ZryHBpdjtR5wuIaT/exec?id_viaje=${idViaje}`)
  .then(res => res.json())
  .then(v => {

    if (v.error) {
      document.getElementById("conecta").innerHTML = v.error;
      return;
    }

    document.getElementById("conecta").innerHTML = `
      <div class="card">

        <div class="tag">Conecta Go</div>

        <div class="row">
          <div class="label">â­ ${v.calificacion_usuario ?? "--"}</div>
          <div class="label">Viajes: ${v.record_viajes_usuario ?? "--"}</div>
        </div>

        <div class="block">ğŸ“ ${v.origen || "Origen no definido"}</div>
        <div class="block">ğŸ ${v.destino || "Destino no definido"}</div>
        <div class="block">ğŸ•’ ${v.paraCuando || "--"}</div>
        <div class="block">ğŸ“ ${v.escribaUna39 || ""}</div>
        <div class="block">ğŸ“ ${v.escribaUna38 || ""}</div>

        <div class="meta">
          <div>${v.distancia_km ?? "--"} km</div>
          <div>${v.tiempoEstimado_minutos ?? "--"} min</div>
        </div>

        <div class="price-box">
          <div class="price-symbol">$</div>
          <div class="price">${v.tarifaEstimada43 ?? "--"}</div>
        </div>

      </div>
    `;
  })
  .catch(err => {
    document.getElementById("conecta").innerHTML = "âŒ Error al cargar viaje";
    console.error(err);
  });
</script>
